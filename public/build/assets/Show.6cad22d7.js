import{a as e,F as y,j as a,H as P,u as w}from"./app.49974c07.js";import{A as F}from"./AdminLayout.c9dc236c.js";import{T as t}from"./Table.2bc70265.js";import{A as I}from"./ActionColumn.58f98b55.js";import{I as h}from"./InstantSubmitInput.903ece13.js";import{P as b}from"./ProductImage.47385f62.js";import{T as g}from"./Tab.6c9f6a5b.js";import{D as m}from"./Show.310b5d18.js";import{P as p}from"./Protocol.5412cada.js";import{I as s}from"./InputLabel.656c0779.js";import{T as f}from"./TextInput.2a5e1393.js";import{B as H}from"./Button.fc16965b.js";import{S as N}from"./Select.b3a17e97.js";import{A as z}from"./AddNewLine.9d1475a8.js";import"./ApplicationLogo.50cd55cd.js";import"./transition.90fac48f.js";import"./index.esm.fad004f0.js";import"./Pagination.212abf77.js";import"./String.db95b830.js";import"./tw-merge.25811ea8.js";import"./ActionButton.e7a692fa.js";import"./AuthenticatedLayout.dbe37321.js";import"./ReservedPrice.c7474cd4.js";import"./string.1d774860.js";import"./attempt.9a3fe2ac.js";import"./Status.3f0997f7.js";import"./ProductListDetails.760d6add.js";const C=({protocol:i})=>{const l=i.protocol_lots;function d(o,n){var c=o.split(" ");return c.splice(n,c.length-1),c.join(" ")+(c.length!==o.split(" ").length?"...":"")}return e(t,{route:route("admin.protocols.show",i.id),className:"pb-4",children:l&&l.length>0?e(y,{children:a(t.Inner,{children:[a(t.HeaderRow,{children:[e(t.Header,{name:"id",children:"Image"}),e(t.Header,{name:"date",children:"Sku"}),e(t.Header,{name:"qty_available",children:"Name"}),e(t.Header,{name:"qty_available",children:"Qt.\xE0 disponibile"}),e(t.Header,{name:"qty_total",children:"Qt.\xE0 totale"}),e(t.Header,{children:"Prezzo originale"}),e(t.Header,{children:"Prezzo riservato"}),e(t.Header,{})]}),e(t.Body,{children:l.map(o=>{const n=o.lot;return a(t.Row,{children:[e(t.Field,{children:e(b,{name:n.product.image,className:"w-12 h-12"})}),e(t.Field,{children:n.product.sku}),e(t.Field,{children:d(n.product.name,5)}),e(t.Field,{children:n.qty_available}),e(t.Field,{children:n.qty_total}),e(t.Field,{children:e(h,{step:.01,min:0,defaultValue:o.original_price,type:"number",id:o.id,name:"original_price",routeName:"admin.protocol_lots.update"})}),e(t.Field,{children:e(h,{step:.01,min:0,defaultValue:o.price,type:"number",id:o.id,name:"price",routeName:"admin.protocol_lots.update"})}),e(I,{del:route("admin.protocol_lots.destroy",o.id)})]},o.id)})})]})}):e("p",{className:"py-4",children:"Nessun lotto presente"})})};function ie(i){const l=i.protocol;return a(F,{auth:i.auth,errors:i.errors,header:e("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Protocollo"}),children:[e(P,{title:"Protocollo"}),e("div",{className:"py-12",children:a("div",{className:"max-w-8xl mx-auto sm:px-6 lg:px-8",children:[a(g,{containerClassName:"mb-4 w-1/2",children:[e(m,{title:"Tipo",children:e("span",{children:p.typeText(l)})}),e(m,{title:"Riferimento",children:e("span",{children:l.referral})}),e(m,{title:"Data",children:p.getDate(l)}),e(m,{title:"Scdenza",children:p.getExpireDate(l)})]}),a(g,{children:[e("h2",{className:"font-semibold mb-4 border-b",children:"Prodotti del protocolo"}),e(C,{protocol:i.protocol}),i.products.length!==0&&e(S,{protocol:i.protocol,products:i.products})]})]})})]})}const S=({protocol:i,products:l})=>{const{data:d,setData:o,post:n,transform:c}=w({id:i.id,product:l[0],lot_id:l[0].lots[0].id,original_price:parseFloat("0").toFixed(2),price:parseFloat("0").toFixed(2)});console.log(d);const x=()=>{c(r=>({...r,product:r.product.id})),n(route("admin.protocol_lots.store"))},u=r=>{o(r.target.name,r.target.value)},v=r=>_=>{o(r,_)};return e(z,{children:a("div",{className:"flex py-4 pt-4 border-t border-indigo-300 items-end",children:[a("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Prodotto",className:"mb-2"}),e(N,{people:l,getName:r=>a("div",{className:"flex items-center",children:[e(b,{name:r.image,className:"w-8 h-8 mr-4 mb-0"}),e("p",{children:r.sku})," "]}),onChange:(()=>r=>{o({...d,product:r,lot_id:r.lots[0].id})})(),getValue:r=>r})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Lotto (Id - Qt.\xE0)",className:"mb-2"}),e(N,{people:d.product.lots,getName:r=>r.id+" - "+r.qty_total,onChange:v("lot_id"),initial:d.product.lots[0]})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo originale",className:"mb-2"}),e(f,{step:.01,type:"number",name:"original_price",value:d.original_price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo riservato",className:"mb-2"}),e(f,{step:.01,type:"number",name:"price",value:d.price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),e(H,{type:"button",onClick:x,children:"Aggiungi"})]})})};export{ie as default};
