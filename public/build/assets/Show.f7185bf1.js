import{a as e,F as y,j as i,H as w,u as F}from"./app.701c8412.js";import{A as I}from"./AdminLayout.da740535.js";import{T as f}from"./Tab.c8dc8a01.js";import{P as v}from"./ProductImage.9596a1e1.js";import{T as t}from"./Table.5afe908a.js";import{A as P}from"./ActionColumn.330abb1f.js";import{I as N}from"./InstantSubmitInput.0ae4c421.js";import{D as m}from"./Show.74f3d3d8.js";import{P as p}from"./Protocol.5412cada.js";import{I as s}from"./InputLabel.161bbc3d.js";import{T as b}from"./TextInput.404c8393.js";import{B as H}from"./Button.8e427060.js";import{S as x}from"./Select.41c11a3a.js";import{A as z}from"./AddNewLine.4b244247.js";import"./ApplicationLogo.195ea916.js";import"./transition.dfaf50e0.js";import"./index.esm.e45dea00.js";import"./tw-merge.25811ea8.js";import"./Pagination.02ccbf5e.js";import"./String.db95b830.js";import"./ActionButton.1e32e0be.js";import"./AuthenticatedLayout.c6eeb50b.js";import"./ReservedPrice.432d9723.js";import"./string.7842d782.js";import"./attempt.42f53801.js";import"./Status.0c9acfad.js";import"./ProductListDetails.906d7f4a.js";const T=({protocol:a})=>{const l=a.protocol_lots;function d(o,n){var c=o.split(" ");return c.splice(n,c.length-1),c.join(" ")+(c.length!==o.split(" ").length?"...":"")}return e(t,{route:route("admin.protocols.show",a.id),className:"pb-4",children:l&&l.length>0?e(y,{children:i(t.Inner,{children:[i(t.HeaderRow,{children:[e(t.Header,{name:"id",children:"Image"}),e(t.Header,{name:"date",children:"Sku"}),e(t.Header,{name:"qty_available",children:"Name"}),e(t.Header,{name:"qty_available",children:"Qt.\xE0 disponibile"}),e(t.Header,{name:"qty_total",children:"Qt.\xE0 totale"}),e(t.Header,{children:"Prezzo originale"}),e(t.Header,{children:"Prezzo riservato"}),e(t.Header,{})]}),e(t.Body,{children:l.map(o=>{const n=o.lot;return i(t.Row,{children:[e(t.Field,{children:e(v,{name:n.product.image,className:"w-12 h-12"})}),e(t.Field,{children:n.product.sku}),e(t.Field,{children:d(n.product.name,5)}),e(t.Field,{children:n.qty_available}),e(t.Field,{children:n.qty_total}),e(t.Field,{children:e(N,{step:.01,min:0,defaultValue:o.original_price,type:"number",id:o.id,name:"original_price",routeName:"admin.protocol_lots.update"})}),e(t.Field,{children:e(N,{step:.01,min:0,defaultValue:o.price,type:"number",id:o.id,name:"price",routeName:"admin.protocol_lots.update"})}),e(P,{del:route("admin.protocol_lots.destroy",o.id)})]},o.id)})})]})}):e("p",{className:"py-4",children:"Nessun lotto presente"})})};function ie(a){const l=a.protocol;return i(I,{auth:a.auth,errors:a.errors,header:e("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Protocollo"}),children:[e(w,{title:"Protocollo"}),e("div",{className:"py-12",children:i("div",{className:"max-w-8xl mx-auto sm:px-6 lg:px-8",children:[i(f,{containerClassName:"mb-4 w-1/2",children:[e(m,{title:"Tipo",children:e("span",{children:p.typeText(l)})}),e(m,{title:"Riferimento",children:e("span",{children:l.referral})}),e(m,{title:"Data",children:p.getDate(l)}),e(m,{title:"Scdenza",children:p.getExpireDate(l)})]}),i(f,{children:[e("h2",{className:"font-semibold mb-4 border-b",children:"Prodotti del protocolo"}),e(T,{protocol:a.protocol}),a.products.length!==0&&e(A,{protocol:a.protocol,products:a.products})]})]})})]})}const A=({protocol:a,products:l})=>{const{data:d,setData:o,post:n,transform:c}=F({id:a.id,product:l[0],lot_id:l[0].lots[0].id,original_price:parseFloat("0").toFixed(2),price:parseFloat("0").toFixed(2)});console.log(d);const _=()=>{c(r=>({...r,product:r.product.id})),n(route("admin.protocol_lots.store"))},u=r=>{o(r.target.name,r.target.value)},h=r=>g=>{console.log(r+" changed"),o(r,g),r==="product"&&o("lot_id",g.lots[0].id)};return e(z,{children:i("div",{className:"flex py-4 pt-4 border-t border-indigo-300 items-end",children:[i("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Prodotto",className:"mb-2"}),e(x,{people:l,getName:r=>i("div",{className:"flex items-center",children:[e(v,{name:r.image,className:"w-8 h-8 mr-4 mb-0"}),e("p",{children:r.sku})," "]}),onChange:h("product"),getValue:r=>r})]}),i("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Lotto (Id - Qt.\xE0)",className:"mb-2"}),e(x,{people:d.product.lots,getName:r=>r.id+" - "+r.qty_total,onChange:h("lot_id"),initial:d.product.lots[0]})]}),i("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo originale",className:"mb-2"}),e(b,{step:.01,type:"number",name:"original_price",value:d.original_price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),i("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo riservato",className:"mb-2"}),e(b,{step:.01,type:"number",name:"price",value:d.price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),e(H,{type:"button",onClick:_,children:"Aggiungi"})]})})};export{ie as default};
