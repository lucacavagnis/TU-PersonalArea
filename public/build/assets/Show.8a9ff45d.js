import{j as e,F as y,a,H as P,u as w}from"./app.b45b0f29.js";import{A as F}from"./AdminLayout.42cbd391.js";import{T as t}from"./Table.f86d7ea8.js";import{A as I,a as H}from"./AddNewLine.5bc63b3d.js";import{I as h}from"./InstantSubmitInput.bc0d3624.js";import{P as b}from"./ProductImage.a5603c41.js";import{T as g}from"./Tab.0b6397fc.js";import{D as m}from"./Show.252beabc.js";import{P as p}from"./Protocol.1726cfb1.js";import{I as s}from"./InputLabel.3443e952.js";import{T as N}from"./TextInput.716bcada.js";import{B as z}from"./Button.8357217c.js";import{S as f}from"./Select.8d842d8a.js";import"./ApplicationLogo.bbdd66d7.js";import"./transition.54d2eece.js";import"./Pagination.4105353b.js";import"./String.081073ca.js";import"./tw-merge.25811ea8.js";import"./ActionButton.ba32aa4d.js";import"./BackgorundImage.d3e17cbc.js";import"./AuthenticatedLayout.22f35c7e.js";import"./index.esm.5d9c0766.js";import"./ReservedPrice.39676e58.js";import"./string.0becc374.js";import"./attempt.6b05409a.js";import"./Status.2380ce67.js";import"./ProductListDetails.a01fc6bc.js";const C=({protocol:i})=>{const l=i.protocol_lots;function d(o,n){var c=o.split(" ");return c.splice(n,c.length-1),c.join(" ")+(c.length!==o.split(" ").length?"...":"")}return e(t,{route:route("admin.protocols.show",i.id),className:"pb-4",children:l&&l.length>0?e(y,{children:a(t.Inner,{children:[a(t.HeaderRow,{children:[e(t.Header,{name:"id",children:"Image"}),e(t.Header,{name:"date",children:"Sku"}),e(t.Header,{name:"qty_available",children:"Name"}),e(t.Header,{name:"qty_available",children:"Qt.\xE0 disponibile"}),e(t.Header,{name:"qty_total",children:"Qt.\xE0 totale"}),e(t.Header,{children:"Prezzo originale"}),e(t.Header,{children:"Prezzo riservato"}),e(t.Header,{})]}),e(t.Body,{children:l.map(o=>{const n=o.lot;return a(t.Row,{children:[e(t.Field,{children:e(b,{name:n.product.image,className:"w-12 h-12"})}),e(t.Field,{children:n.product.sku}),e(t.Field,{children:d(n.product.name,5)}),e(t.Field,{children:n.qty_available}),e(t.Field,{children:n.qty_total}),e(t.Field,{children:e(h,{step:.01,min:0,defaultValue:o.original_price,type:"number",id:o.id,name:"original_price",routeName:"admin.protocol_lots.update"})}),e(t.Field,{children:e(h,{step:.01,min:0,defaultValue:o.price,type:"number",id:o.id,name:"price",routeName:"admin.protocol_lots.update"})}),e(I,{del:route("admin.protocol_lots.destroy",o.id)})]},o.id)})})]})}):e("p",{className:"py-4",children:"Nessun lotto presente"})})};function ie(i){const l=i.protocol;return a(F,{auth:i.auth,errors:i.errors,header:e("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Protocollo"}),children:[e(P,{title:"Protocollo"}),e("div",{className:"py-12",children:a("div",{className:"max-w-8xl mx-auto sm:px-6 lg:px-8",children:[a(g,{containerClassName:"mb-4 w-1/2",children:[e(m,{title:"Tipo",children:e("span",{children:p.typeText(l)})}),e(m,{title:"Riferimento",children:e("span",{children:l.referral})}),e(m,{title:"Data",children:p.getDate(l)}),e(m,{title:"Scdenza",children:p.getExpireDate(l)})]}),a(g,{children:[e("h2",{className:"font-semibold mb-4 border-b",children:"Prodotti del protocolo"}),e(C,{protocol:i.protocol}),i.products.length!==0&&e(S,{protocol:i.protocol,products:i.products})]})]})})]})}const S=({protocol:i,products:l})=>{const{data:d,setData:o,post:n,transform:c}=w({id:i.id,product:l[0],lot_id:l[0].lots[0].id,original_price:parseFloat("0").toFixed(2),price:parseFloat("0").toFixed(2)});console.log(d);const x=()=>{c(r=>({...r,product:r.product.id})),n(route("admin.protocol_lots.store"))},u=r=>{o(r.target.name,r.target.value)},v=r=>_=>{o(r,_)};return e(H,{children:a("div",{className:"flex py-4 pt-4 border-t border-indigo-300 items-end",children:[a("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Prodotto",className:"mb-2"}),e(f,{people:l,getName:r=>a("div",{className:"flex items-center",children:[e(b,{name:r.image,className:"w-8 h-8 mr-4 mb-0"}),e("p",{children:r.sku})," "]}),onChange:(()=>r=>{o({...d,product:r,lot_id:r.lots[0].id})})(),getValue:r=>r})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Lotto (Id - Qt.\xE0)",className:"mb-2"}),e(f,{people:d.product.lots,getName:r=>r.id+" - "+r.qty_total,onChange:v("lot_id"),initial:d.product.lots[0]})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo originale",className:"mb-2"}),e(N,{step:.01,type:"number",name:"original_price",value:d.original_price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),a("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo riservato",className:"mb-2"}),e(N,{step:.01,type:"number",name:"price",value:d.price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),e(z,{type:"button",onClick:x,children:"Aggiungi"})]})})};export{ie as default};
