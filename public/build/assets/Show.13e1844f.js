import{a as i,j as t,F as u,r as _,u as R,H as F,L as w,d as z}from"./app.363ed9f1.js";import{A as H,C as D}from"./AuthenticatedLayout.c4b6d95e.js";import{T}from"./Tab.2e64c000.js";import{R as k}from"./ReservedPrice.38b5727d.js";import{P as j}from"./ProductImage.01070709.js";import{T as $}from"./TextInput.69fd9cda.js";import{B as q}from"./Button.340eadde.js";import{q as A,l as M,i as I,a as U}from"./Product.2753c164.js";import{T as l}from"./Table.6ff21a5f.js";import{F as W}from"./String.081073ca.js";import{A as O}from"./ApplicationLogo.64869274.js";import{a as S,b as Q}from"./index.esm.c5a33117.js";import{B as V}from"./Box.9f6d6e5f.js";import{h as G,g as J,l as E,_ as v,c as N,p as K,k as X,b as Y,i as Z}from"./Close.0e3a87e0.js";import{B as ee}from"./ClickAwayListener.3bc0bcd2.js";import{C as te}from"./CircularProgress.02bb978b.js";import{S as ae,A as ie}from"./Alert.67031798.js";import"./transition.13d8f845.js";import"./tw-merge.25811ea8.js";import"./BackgorundImage.34bc7331.js";import"./Pagination.23cd9209.js";function ne({total:a,partial:e,size:n="big"}){return i("div",{className:"mb-4",children:[n==="small"?i("span",{className:A(e,a)+" font-bold text-sm uppercase",children:[e," di ",a]}):i("h3",{className:"uppercase font-bold mb-2",children:[t("span",{className:M(e,a)+" h-3 w-3 inline-block rounded-full mr-2"}),i("span",{className:"align-middle",children:[e," disponibile su ",a]})]}),t("div",{className:"w-full h-2 rounded bg-slate-200 relative",children:t("div",{className:" h-full absolute left-0 bg-emerald-700 rounded",style:{width:e/a*100+"%"}})})]})}const oe=({isInWarehouse:a,extended:e})=>t(u,{children:a&&i("div",{className:"flex  mr-2 items-center",children:[t(O,{className:"w-4"}),e&&t("span",{className:"ml-2",children:"Pronta consegna"})]})}),se=({isPayed:a,extended:e})=>t(u,{children:t("div",{className:"flex  mr-2 items-center",children:a?i(u,{children:[t(Q,{className:"text-slate-700"}),e&&t("span",{className:"ml-2",children:"Gi\xE0 fatturato"})]}):i(u,{children:[t(S,{className:"text-slate-700"}),e&&t("span",{className:"ml-2",children:"Da fatturare"})]})})});function re({lot:a,extended:e=!1}){return i("div",{className:"flex mb-2 group",children:[t(oe,{isInWarehouse:a.locations&&a.locations.length>0,extended:e}),t(se,{isPayed:a.protocol_lot&&a.protocol_lot.protocol&&!a.protocol_lot.protocol.type,extended:e})]})}function le(a){return J("MuiLoadingButton",a)}const de=G("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),m=de,ce=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],me=a=>{const{loading:e,loadingPosition:n,classes:s}=a,r={root:["root",e&&"loading"],startIcon:[e&&`startIconLoading${N(n)}`],endIcon:[e&&`endIconLoading${N(n)}`],loadingIndicator:["loadingIndicator",e&&`loadingIndicator${N(n)}`]},d=Z(r,le,s);return v({},s,d)},ue=a=>a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"&&a!=="classes",he=E(ee,{shouldForwardProp:a=>ue(a)||a==="classes",name:"MuiLoadingButton",slot:"Root",overridesResolver:(a,e)=>[e.root,e.startIconLoadingStart&&{[`& .${m.startIconLoadingStart}`]:e.startIconLoadingStart},e.endIconLoadingEnd&&{[`& .${m.endIconLoadingEnd}`]:e.endIconLoadingEnd}]})(({ownerState:a,theme:e})=>v({[`& .${m.startIconLoadingStart}, & .${m.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},a.loadingPosition==="center"&&{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${m.loading}`]:{color:"transparent"}},a.loadingPosition==="start"&&a.fullWidth&&{[`& .${m.startIconLoadingStart}, & .${m.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0,marginRight:-8}},a.loadingPosition==="end"&&a.fullWidth&&{[`& .${m.startIconLoadingStart}, & .${m.endIconLoadingEnd}`]:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0,marginLeft:-8}})),ge=E("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(a,e)=>{const{ownerState:n}=a;return[e.loadingIndicator,e[`loadingIndicator${N(n.loadingPosition)}`]]}})(({theme:a,ownerState:e})=>v({position:"absolute",visibility:"visible",display:"flex"},e.loadingPosition==="start"&&(e.variant==="outlined"||e.variant==="contained")&&{left:e.size==="small"?10:14},e.loadingPosition==="start"&&e.variant==="text"&&{left:6},e.loadingPosition==="center"&&{left:"50%",transform:"translate(-50%)",color:(a.vars||a).palette.action.disabled},e.loadingPosition==="end"&&(e.variant==="outlined"||e.variant==="contained")&&{right:e.size==="small"?10:14},e.loadingPosition==="end"&&e.variant==="text"&&{right:6},e.loadingPosition==="start"&&e.fullWidth&&{position:"relative",left:-10},e.loadingPosition==="end"&&e.fullWidth&&{position:"relative",right:-10})),pe=_.exports.forwardRef(function(e,n){const s=K({props:e,name:"MuiLoadingButton"}),{children:r,disabled:d=!1,id:x,loading:h=!1,loadingIndicator:g,loadingPosition:f="center",variant:p="text"}=s,o=X(s,ce),c=Y(x),y=g!=null?g:t(te,{"aria-labelledby":c,color:"inherit",size:16}),b=v({},s,{disabled:d,loading:h,loadingIndicator:y,loadingPosition:f,variant:p}),L=me(b),C=h?t(ge,{className:L.loadingIndicator,ownerState:b,children:y}):null;return i(he,v({disabled:d||h,id:c,ref:n},o,{variant:p,classes:L,ownerState:b,children:[b.loadingPosition==="end"?r:C,b.loadingPosition==="end"?C:r]}))}),fe=pe;function We(a){console.log(a);const e=a.product,{data:n,setData:s,post:r,reset:d}=R({product_id:e.id,qty:0}),x=(o,c)=>{o.preventDefault(),r(route("cart.store"),{preserveScroll:!0,onSuccess:()=>{d(),c()}})},h=o=>{o.preventDefault(),s(o.target.name.split("-")[0],n[o.target.name.split("-")[0]].map((c,y)=>y===parseInt(o.target.name.split("-")[1])?{id:c.id,qty:parseInt(o.target.value)}:c))},g=o=>{o.preventDefault(),s(o.target.name,parseInt(o.target.value))};let f=[],p=[];return e.lots.forEach((o,c)=>{o.qty_available-o.qty_requested>0?f.push(t(ve,{lot:o,data:n,id:c,onChange:h})):p.push(t(xe,{product:o}))}),t("div",{children:i(H,{auth:a.auth,errors:a.errors,header:a.product.name,children:[t(F,{children:t("title",{children:a.product.name})}),t("div",{className:"py-12",children:i("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[t(be,{product:e,children:e.qty_available-e.qty_requested>0?i(u,{children:[i("div",{className:"flex items-center mt-2",children:[t($,{name:"qty",value:n.qty,type:"number",min:0,max:e.qty_available-e.qty_requested,handleChange:o=>g(o),className:"mr-4"}),t("p",{className:"font-bold",children:"/ "+(e.qty_available-e.qty_requested)+" disponibili"})]}),i("div",{className:"flex items-baseline",children:[t(Ne,{className:"mr-2",submit:x}),t(P,{product:e})]})]}):i("div",{children:[t("p",{className:"font-bold text-lg text-red-700",children:"Esaurito / Disponibilit\xE0 da verificare"}),t(P,{product:e})]})}),i("div",{className:"flex justify-between",id:"warehouse",children:[t(B,{title:"Lotti in magazzino",position:"first",children:f.length===0?t("p",{children:"Prodotto non presente in magazzino"}):t(u,{children:f})}),t(B,{title:"Storico lotti",position:"second",children:t(ye,{children:p.length===0?t("p",{children:"Prodotto non presente in storico"}):p})})]})]})})]})})}const P=({product:a})=>{const[e,n]=_.exports.useState(!1),[s,r]=_.exports.useState(!1),d=(h,g)=>{g!=="clickaway"&&r(!1)};return i(V,{children:[t(fe,{onClick:()=>{z.Inertia.post(route("products.quotation",a.id),{},{onStart:()=>{n(!0)},onFinish:()=>{n(!1),r(!0)}})},loading:e,loadingPosition:"end",variant:"contained",sx:{background:"#1d4ed8"},children:t("span",{children:"Richiedi nuova quotazione"})}),t(ae,{open:s,autoHideDuration:6e3,onClose:d,children:t(ie,{onClose:d,severity:"success",sx:{width:"100%"},children:"Richiesta inviata"})})]})},be=({children:a,product:e})=>i(T,{className:"flex justify-between w-full mb-4",children:[t("div",{className:"w-1/2 mr-4 relative",children:t(j,{name:e.image,className:"h-full"})}),t("div",{className:"w-1/2 ml-4",children:i("div",{className:"mb-8",children:[t("span",{className:"mb-2 block",children:e.sku}),t("h1",{className:"font-bold hover:underline",children:t(w,{href:route("products.show",e.id),children:e.name})}),e.last_original_price!==null&&e.last_original_price!==0&&i("div",{className:"mb-4 flex items-baseline",children:[t(k,{fullPrice:e.qty_available-e.qty_requested>0?e.last_original_price:null,reservedPrice:e.qty_available-e.qty_requested?e.last_price:e.last_original_price,className:"text-lg mr-2"}),e.qty_available-e.qty_requested>0&&t("p",{className:"text-sm text-gray-500",children:"Ultima quotazione"})]}),t("p",{className:"uppercase font-semibold mb-4 text-slate-500 text-sm",children:e.categories.map((n,s)=>i("span",{children:[s!==0&&t("span",{className:"mx-2",children:"/"}),n.ancestors_and_self.map((r,d)=>i("span",{children:[d!==0&&t("span",{className:"mx-1",children:"-"}),r.name]}))]}))}),t("p",{className:"mb-4",children:e.desc}),a]})})]}),ve=({lot:a})=>{const e=a;return t("div",{className:"mb-4 border-b pb-2",children:i("div",{className:"flex justify-between",children:[i("div",{className:"min-w-[50%]",children:[t(re,{lot:a,extended:!0}),t(ne,{partial:e.qty_available-e.qty_requested,total:e.qty_total,size:"small"})]}),i("div",{className:"text-right",children:[t("span",{className:"text-sm text-slate-700",children:W(e.date)}),a.protocol_lot&&t(u,{children:t(q,{kind:"tertiary",href:route("protocols.show",a.protocol_lot.protocol_id),className:"flex align-items-center",children:"Vedi protocollo"})})]})]})})},xe=({product:a})=>{const e="[&>*]:py-4";return i(l.Row,{className:"border-b border-slate-100 text-sm "+e,children:[t(l.Field,{children:I(a)?"Tutto Ufficio":"Terzi"}),t(l.Field,{children:U(a)?"Conto aperto":"Conto deposito"}),t(l.Field,{children:a.qty_total}),t(l.Field,{children:I(a)&&t(q,{type:"link",kind:"tertiary",href:route("protocols.show",a.protocol_lot.protocol.id),className:"mt-0 align-middle",children:"Vedi protocollo"})})]},a.id)},ye=({children:a})=>t(l,{children:i(l.Inner,{children:[i(l.HeaderRow,{children:[t(l.Header,{children:"Fornitore"}),t(l.Header,{children:"Tipo"}),t(l.Header,{children:"Q.t\xE0"}),t(l.Header,{})]}),t(l.Body,{children:a})]})}),B=({title:a,children:e,position:n})=>t(T,{containerClassName:(n==="first"?"mr-2":"ml-2")+" w-1/2",children:i("div",{children:[t("h2",{className:"font-bold mb-4",children:a}),e]})}),Ne=({submit:a,className:e})=>{const{openCart:n}=_.exports.useContext(D);return t(q,{type:"submit",className:e,onClick:s=>{a(s,n)},children:"Aggiungi al carrello"})},Oe=({name:a,product:e,qty:n,onChange:s})=>i("div",{children:[I(e)&&t(k,{reservedPrice:e.protocol_product.price,fullPrice:e.protocol_product.original_price}),i("div",{className:"flex items-center",children:[t($,{name:a,value:n,type:"number",min:0,max:e.qty_available-e.qty_requested,handleChange:r=>s(r),className:"mr-4"}),t("span",{className:"text-lg font-bold",children:"di "+(e.qty_available-e.qty_requested)+" disponibili"})]})]});export{Oe as BuyInput,Ne as CartButton,be as ProductDataTab,We as default};
