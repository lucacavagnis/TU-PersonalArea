import{a as e,F as y,j as o,H as w,u as I}from"./app.73e76765.js";import{A as P}from"./AdminLayout.9d374397.js";import{T as g}from"./Tab.fa1f7e8c.js";import{P as v}from"./ProductImage.264793d6.js";import{T as r}from"./Table.b1087b63.js";import{A as H}from"./ActionColumn.19b7e7d4.js";import{I as f}from"./InstantSubmitInput.7b2fb3ee.js";import{D as c}from"./Show.5d221d1b.js";import{P as p}from"./Protocol.8a54e017.js";import{I as s}from"./InputLabel.2e8ef07d.js";import{T as N}from"./TextInput.7cea473b.js";import{B as F}from"./Button.1ebd24a1.js";import{S as b}from"./Select.739f28b6.js";import{A as z}from"./AddNewLine.902eb09e.js";import"./ApplicationLogo.63312593.js";import"./transition.f8bd1af7.js";import"./index.esm.e717573f.js";import"./tw-merge.25811ea8.js";import"./Pagination.36c02ab2.js";import"./String.ccfadc51.js";import"./ActionButton.0fbbfeff.js";import"./AuthenticatedLayout.71b1ea15.js";import"./ReservedPrice.7339d89c.js";import"./string.9f302a1e.js";import"./attempt.00b5a03c.js";import"./Status.053521ef.js";import"./ProductListDetails.ff9e5b5d.js";const T=({protocol:a})=>{const i=a.protocol_lots;function m(l,n){var d=l.split(" ");return d.splice(n,d.length-1),d.join(" ")+(d.length!==l.split(" ").length?"...":"")}return e(r,{route:route("admin.protocols.show",a.id),className:"pb-4",children:i&&i.length>0?e(y,{children:o(r.Inner,{children:[o(r.HeaderRow,{children:[e(r.Header,{name:"id",children:"Image"}),e(r.Header,{name:"date",children:"Sku"}),e(r.Header,{name:"qty_available",children:"Name"}),e(r.Header,{name:"qty_available",children:"Qt.\xE0 disponibile"}),e(r.Header,{name:"qty_total",children:"Qt.\xE0 totale"}),e(r.Header,{children:"Prezzo originale"}),e(r.Header,{children:"Prezzo riservato"}),e(r.Header,{})]}),e(r.Body,{children:i.map(l=>{const n=l.lot;return o(r.Row,{children:[e(r.Field,{children:e(v,{name:n.product.image,className:"w-12 h-12"})}),e(r.Field,{children:n.product.sku}),e(r.Field,{children:m(n.product.name,5)}),e(r.Field,{children:n.qty_available}),e(r.Field,{children:n.qty_total}),e(r.Field,{children:e(f,{step:.01,min:0,defaultValue:l.original_price,type:"number",id:l.id,name:"original_price",routeName:"admin.protocol_lots.update"})}),e(r.Field,{children:e(f,{step:.01,min:0,defaultValue:l.price,type:"number",id:l.id,name:"price",routeName:"admin.protocol_lots.update"})}),e(H,{del:route("admin.protocol_lots.destroy",n.id)})]},l.id)})})]})}):e("p",{className:"py-4",children:"Nessun lotto presente"})})};function ae(a){const i=a.protocol;return o(P,{auth:a.auth,errors:a.errors,header:e("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Protocollo"}),children:[e(w,{title:"Protocollo"}),e("div",{className:"py-12",children:o("div",{className:"max-w-8xl mx-auto sm:px-6 lg:px-8",children:[o(g,{containerClassName:"mb-4 w-1/2",children:[e(c,{title:"Tipo",children:e("span",{children:p.typeText(i)})}),e(c,{title:"Riferimento",children:e("span",{children:i.referral})}),e(c,{title:"Data",children:p.getDate(i)}),e(c,{title:"Scdenza",children:p.getExpireDate(i)})]}),o(g,{children:[e("h2",{className:"font-semibold mb-4 border-b",children:"Prodotti del protocolo"}),e(T,{protocol:a.protocol}),a.products.length!=0&&e(A,{protocol:a.protocol,products:a.products})]})]})})]})}const A=({protocol:a,products:i})=>{const{data:m,setData:l,post:n,transform:d}=I({id:a.id,product:i[0],lot_id:i[0].lots[0].id,original_price:0,price:0}),x=()=>{d(t=>({...t,product:t.product.id})),n(route("admin.protocol_lots.store"))},u=t=>{l(t.target.name,t.target.value)},h=t=>_=>{l(t,_)};return e(z,{children:o("div",{className:"flex py-4 pt-4 border-t border-indigo-300 items-end",children:[o("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Prodotto",className:"mb-2"}),e(b,{people:i,getName:t=>o("div",{className:"flex items-center",children:[e(v,{name:t.image,className:"w-8 h-8 mr-4 mb-0"}),e("p",{children:t.sku})," "]}),onChange:h("product"),getValue:t=>t})]}),o("div",{className:"mr-4",children:[e(s,{forInput:"product",value:"Lotto (Id - Qt.\xE0)",className:"mb-2"}),e(b,{people:m.product.lots,getName:t=>t.id+" - "+t.qty_total,onChange:h("lot_id")})]}),o("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo originale",className:"mb-2"}),e(N,{step:.01,type:"number",name:"original_price",value:m.original_price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),o("div",{className:"mr-4",children:[e(s,{forInput:"date",value:"Prezzo riservato",className:"mb-2"}),e(N,{step:.01,type:"number",name:"price",value:m.price,min:0,handleChange:u,className:"min-w-[8rem]"})]}),e(F,{type:"button",onClick:x,children:"Aggiungi"})]})})};export{ae as default};
