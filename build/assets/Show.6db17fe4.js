import{a as r,j as t,r as m,u as q,H as _,F as w}from"./app.78351115.js";import{C as P,b as k,B as f,a as C,A as S,P as A}from"./AuthenticatedLayout.ef00b35d.js";import{T as D}from"./Tab.e1f04ee8.js";import{C as F}from"./Checkbox.15630537.js";import{T as y}from"./TextInput.33b7277f.js";import{j}from"./transition.fcbacdfa.js";import{A as p}from"./Attribute.1c314b0f.js";import{l as O}from"./Product.96c2b9f1.js";import"./ApplicationLogo.7addb485.js";import"./tw-merge.25811ea8.js";function T({product:e}){var a,i,n;return r("div",{className:"mb-4 mt-4",children:[t(p,{title:"Protocollo TU",value:(a=e.prot_number)!=null?a:"---",className:"border-t"}),t(p,{title:"Data protocollo",value:(i=e.prot_date)!=null?i:"---"}),t(p,{title:"Codice ordine",value:(n=e.order_code)!=null?n:"---"})]})}function z(e){return t("div",{className:"mr-6",children:r("label",{className:"ml-2 text-sm align-middle",htmlFor:e.name,children:[t(F,{handleChange:a=>e.handleChange(a),name:e.name,value:e.value,className:"mr-2"}),e.children]})})}function B(e){return t("div",{className:"mr-6",children:r("label",{className:"ml-2 text-sm align-middle flex",htmlFor:e.name,children:[e.children,t(y,{handleChange:a=>e.handleChange(a),name:e.name,placeholder:e.placeholder,className:"mx-2 p-0 text-sm pl-2 "})]})})}function H(e){const a=n=>e.services.length===0?t("p",{children:"Nessun servizio disponibile"}):e.services.map(l=>{switch(l.type){default:case"checkbox":return t(z,{handleChange:d=>e.handleChange(d),name:n+"-"+l.id,children:l.name});case"ip":return t(B,{handleChange:d=>e.handleChange(d),name:n+"-"+l.id,placeholder:"127.0.0.1",children:l.name})}});return t("div",{children:(()=>{var n=[];for(let l=0;l<e.qty_requested;l++)n.push(t(U,{title:e.product.name,children:a(l)},l));return n})()})}function U(e){const[a,i]=m.exports.useState(!1),n=()=>{i(l=>!l),console.log(a)};return r("div",{className:"relative mb-4 pb-2 border-b-gray-200 border-b",children:[r("h3",{className:"pb-1 font-semibold",children:[e.title,t(j,{className:(a?"rotate-180 ":" ")+" transition-transform cursor-pointer float-right",onClick:n})]}),t("div",{className:(a?" ":"h-0 ")+"overflow-hidden transition-all flex flex-wrap",children:e.children})]})}const E=e=>{const a=i=>{i.stopPropagation()};return t("div",{children:t("div",{className:(e.open?"":"opacity-0 pointer-events-none ")+"transition-opacity overflow-auto  fixed top-0 left-0 z-50 w-full h-full bg-zinc-900/50 p-10",onClick:i=>e.triggerClose(i),children:r("div",{onClick:i=>a(i),className:"relative",children:[t(P,{onClick:i=>e.triggerClose(i)}),e.children]})})})},R=e=>{const{product:a,services:i,processing:n,data:l,setData:d,onHandleChange:g,triggerClose:u,post:v,...b}=e,{openCart:o}=m.exports.useContext(k),h=s=>{v(route("cart.store"),{onSuccess:()=>{u(),o(s)}})},c=m.exports.useRef(!0);m.exports.useEffect(()=>{c.current?c.current=!1:h()},[l.redirect]);const x=(s,N)=>{s.preventDefault(),N!==l.redirect?d("redirect",N):h()};return t(E,{...b,triggerClose:u,children:r("form",{className:"overflow-auto relative rounded-lg w-5/5 ml-auto mr-auto bg-white px-6 py-8 ",children:[r("div",{className:"mb-10",children:[t("h2",{className:"font-bold",children:"Configura i tuoi prodotti"}),t("p",{className:"mb-2",children:"Puoi richiedere dei servizi aggiuntivi sui proddoti che stai per acquistare, ottieni cos\xEC il massimo dai tuoi acquisti e non ti preoccupi pi\xF9 di niente."})]}),t("div",{className:"",children:t(H,{product:a,qty_requested:l.qty,handleChange:g,services:i})}),r("div",{className:"flex w-full justify-start",children:[t(f,{type:"submit",className:"mr-4",onClick:s=>x(s,!1),disabled:n||l.qty<1,children:"Aggiungi al carrello"}),t(f,{type:"submit",onClick:s=>x(s,!0),disabled:n||l.qty<1,children:"Acquista subito"})]})]})})},I=R;function L(e){return t("div",{children:r("p",{className:e.className,children:[t(C,{value:e.fullPrice,className:"line-through text-slate-500"})," ",t(C,{value:e.reservedPrice})]})})}function Z(e){const{data:a,setData:i,post:n,processing:l}=q({qty:0,product_id:e.product.id,redirect:!1}),d=c=>{i(c.target.name,c.target.type==="checkbox"?c.target.checked:c.target.value)},[g,u]=m.exports.useState(!1),v=c=>{c&&c.preventDefault(),u(!1)},b=c=>{c.preventDefault(),a.qty>0&&u(!0)},o=e.product.remaining_days===0,h=e.product.qty_available-e.product.qty_requested;return t("div",{children:r(S,{auth:e.auth,errors:e.errors,header:e.product.name,children:[t(_,{children:t("title",{children:e.product.name})}),t("div",{className:"py-12",children:r("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[t(I,{product:e.product,services:e.services,onHandleChange:d,data:a,setData:i,processing:l,open:g,post:n,triggerClose:v}),r(D,{className:"flex justify-between w-full",children:[r("div",{className:"w-1/2 mr-4 relative",children:[t("div",{className:"absolute top-1 left-1",children:t("span",{className:(o?"bg-rose-500":"bg-slate-500")+" uppercase text-sm p-2 rounded font-bold text-white",children:o?"Scaduto":"Scade il "+e.product.expire_date})}),t(A,{name:e.product.image,className:"h-full"})]}),r("div",{className:"w-1/2 ml-4",children:[t("h1",{className:"font-bold",children:e.product.name}),t(L,{fullPrice:e.product.price,reservedPrice:e.product.reserved_price,className:"text-xl mb-4 font-semibold"}),r("h3",{className:"uppercase font-bold mb-2",children:[t("span",{className:O(e.product)+" h-3 w-3 inline-block rounded-full mr-2"}),r("span",{className:"align-middle",children:[h," disponibile su ",e.product.qty_total]})]}),t(T,{product:e.product}),t("p",{className:"mb-4",children:e.product.desc}),t("div",{children:r("div",{children:[e.product.qty_available>0&&!o&&r(w,{children:[t(y,{type:"number",name:"qty",className:"mt-1 block w-full",autoComplete:"qty",value:a.qty,isFocused:!0,max:e.product.qty_available-e.cart_qta,handleChange:d,min:0}),t("div",{onClick:c=>b(c),children:t(f,{type:"button",disabled:a.qty<1,children:"Acquista"})})]}),(e.product.qty_available===0||o)&&e.auth.user.role===1&&t(f,{type:"link",href:"",children:"Ordina di nuovo"})]})})]})]})]})})]})})}export{Z as default};
